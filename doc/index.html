<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>
  File: README.ja
  
    &mdash; Documentation by YARD 0.8.7.6
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!file.README.ja.html";
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README.ja</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><div id='filecontents'>
<h1 id="label-MatchSkeleton+-+Equivalent+to+MatchData+with+less+memory+use">MatchSkeleton - Equivalent to MatchData with less memory use</h1>

<p>This package provides the class <span class='object_link'><a href="MatchSkeleton.html" title="MatchSkeleton (class)">MatchSkeleton</a></span>. It behaves almost exactly
like <span class='object_link'><a href="MatchData.html" title="MatchData (class)">MatchData</a></span>, except it uses a greatly less and practically negligible
internal memory.</p>

<p>The built-in <span class='object_link'><a href="MatchData.html" title="MatchData (class)">MatchData</a></span> class holds a copy of the original String, from
which the matched data are derived, in a “freeze” state.  It is useful
because no one can by chance destructively modify the original string. 
However, if is memory-savvy.  Even if <span class='object_link'><a href="MatchData.html" title="MatchData (class)">MatchData</a></span> is the match of the first
few characters of a 1-GB string, it internally holds the entire 1-GB of the
original string.  If a code running holds 1000 of them, it needs a memory
use of 1TB(!).</p>

<p>This class holds the same information of the matched data as <span class='object_link'><a href="MatchData.html" title="MatchData (class)">MatchData</a></span>
but as positional indices, and the original String object only. Therefore,
as long as the original String is not destructively modified by an external
process, any method of this class returns the equal result as <span class='object_link'><a href="MatchData.html" title="MatchData (class)">MatchData</a></span>. 
Note that while the instance of this class is kept, the original string is
not garbage-collected by the Ruby interpreter.</p>

<p>One additional function this class offers is the instance variable and
method <code>pos_begin</code>.  It can be set by a user and hold the
information (Integer) at which position the Regexp match has started to
generate the matched data.</p>

<p>Note this library, when required, also modifies the operator <span class='object_link'><a href="MatchData.html#%3D%3D-instance_method" title="MatchData#== (method)">MatchData#==</a></span>
so that it can be compared with <span class='object_link'><a href="MatchSkeleton.html" title="MatchSkeleton (class)">MatchSkeleton</a></span> objects. Now the operator
is simply based on duck-typing of #string, #regexp, and #pre_match.
MatchData#eql? is not affected, and therefore any comparison between
<span class='object_link'><a href="MatchData.html" title="MatchData (class)">MatchData</a></span> and <span class='object_link'><a href="MatchSkeleton.html" title="MatchSkeleton (class)">MatchSkeleton</a></span> objects with MatchData#eql? or
<span class='object_link'><a href="MatchSkeleton.html#eql%3F-instance_method" title="MatchSkeleton#eql? (method)">MatchSkeleton#eql?</a></span> returns false.</p>

<h2 id="label-Install">Install</h2>

<p>The standard procedure to install a gem should work:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_match_skeleton'>match_skeleton</span>
</code></pre>

<p>Or, get it from <a href="https://rubygems.org/gems/match_skeleton" target="_parent" title="https://rubygems.org/gems/match_skeleton">https://rubygems.org/gems/match_skeleton</a></p>

<p>Then just require as</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>match_skeleton</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<p>Have fun!</p>

<h2 id="label-Simple+Examples">Simple Examples</h2>

<p>Here are some simple examples.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>match_skeleton</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Something_Big.</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_pos'>pos</span> <span class='op'>=</span> <span class='int'>3</span>
<span class='id identifier rubyid_mtch'>mtch</span> <span class='op'>=</span> <span class='id identifier rubyid_str'>str</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(.)big</span><span class='regexp_end'>/i</span></span><span class='comma'>,</span> <span class='id identifier rubyid_pos'>pos</span><span class='rparen'>)</span>
<span class='id identifier rubyid_mskn'>mskn</span> <span class='op'>=</span> <span class='const'>MatchSkeleton</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_mtch'>mtch</span><span class='comma'>,</span> <span class='id identifier rubyid_str'>str</span><span class='comma'>,</span> <span class='label'>pos_begin:</span> <span class='id identifier rubyid_pos'>pos</span><span class='rparen'>)</span>

<span class='id identifier rubyid_mtch'>mtch</span> <span class='op'>==</span> <span class='id identifier rubyid_mskn'>mskn</span>     <span class='comment'># =&gt; true
</span><span class='id identifier rubyid_mskn'>mskn</span><span class='period'>.</span><span class='id identifier rubyid_string'>string</span>      <span class='comment'># =&gt; &quot;Something_Big.&quot;
</span><span class='id identifier rubyid_mskn'>mskn</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>          <span class='comment'># =&gt; &quot;_&quot;
</span><span class='id identifier rubyid_mskn'>mskn</span><span class='period'>.</span><span class='id identifier rubyid_pos_begin'>pos_begin</span>   <span class='comment'># =&gt; 3
</span>
<span class='id identifier rubyid_mskn'>mskn</span><span class='period'>.</span><span class='id identifier rubyid_post_match'>post_match</span>  <span class='comment'># =&gt; &quot;.&quot;
</span><span class='id identifier rubyid_mtch'>mtch</span><span class='period'>.</span><span class='id identifier rubyid_post_match'>post_match</span>  <span class='comment'># =&gt; &quot;.&quot;
</span><span class='id identifier rubyid_str'>str</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>1</span><span class='comma'>,</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_mskn'>mskn</span><span class='period'>.</span><span class='id identifier rubyid_post_match'>post_match</span>  <span class='comment'># =&gt; &quot;%&quot;  # The original string has been destructively modified.  Do not do that...
</span><span class='id identifier rubyid_mtch'>mtch</span><span class='period'>.</span><span class='id identifier rubyid_post_match'>post_match</span>  <span class='comment'># =&gt; &quot;.&quot;
</span><span class='id identifier rubyid_mtch'>mtch</span> <span class='op'>==</span> <span class='id identifier rubyid_mskn'>mskn</span>     <span class='comment'># =&gt; false
</span></code></pre>

<h2 id="label-Known+bugs">Known bugs</h2>
<ul><li>
<p>None.</p>
</li></ul>

<p>This library has been tested in Ruby 2.0 or later only. It may work in Ruby
1.8, but has not been tested.</p>

<p>Extensive tests have been performed, as included in the package.</p>

<h2 id="label-Acknowledgement">Acknowledgement</h2>

<p>This work is supported by <a href="http://www.wisebabel.com/">Wise Babel
Ltd</a>.</p>

<p><a href="http://www.wisebabel.com/" target="_parent" title="http://www.wisebabel.com/">http://www.wisebabel.com/</a></p>

<h2 id="label-Copyright+etc">Copyright etc</h2>
<dl class="rdoc-list note-list"><dt>Author
<dd>
<p>Masa Sakano &lt; imagine a_t sakano dot co dot uk &gt;</p>
</dd><dt>License
<dd>
<p>MIT.</p>
</dd><dt>Warranty
<dd>
<p>No warranty whatsoever.</p>
</dd><dt>Versions
<dd>
<p>The versions of this package follow Semantic Versioning (2.0.0) <a
href="http://semver.org">semver.org</a>/</p>
</dd></dl>

<h1 id="label-MatchSkeleton+-+MatchData-E3-81-AB-E7-AD-89-E4-BE-A1-E3-81-A7-E3-83-A1-E3-83-A2-E3-83-AA-E3-82-92-E7-AF-80-E7-B4-84-E3-81-99-E3-82-8B-E3-82-AF-E3-83-A9-E3-82-B9">MatchSkeleton - MatchDataに等価でメモリを節約するクラス</h1>

<p>クラス <span class='object_link'><a href="MatchSkeleton.html" title="MatchSkeleton (class)">MatchSkeleton</a></span> のGemです。 <span class='object_link'><a href="MatchData.html" title="MatchData (class)">MatchData</a></span>とほぼ完全に等価な動作をします。ただし、メモリ使用量は
比較してはるかに少なくなり、ほぼ無視できます。</p>

<p>組込<span class='object_link'><a href="MatchData.html" title="MatchData (class)">MatchData</a></span>クラスは、正規表現マッチした元の文字列(String)のコピーを
“freeze”した状態で保持します。おかげで、外部のプロセスが元文字列を
破壊的に変更して<span class='object_link'><a href="MatchData.html" title="MatchData (class)">MatchData</a></span>のオブジェクトも影響を受ける、ということは ありません。しかし、それはメモリ使用量が巨大になり得ます。たとえば、
<span class='object_link'><a href="MatchData.html" title="MatchData (class)">MatchData</a></span>オブジェクトが1GBの文字列の最初の数文字だけのマッチだったと
しても、同オブジェクトは、その1GBの文字列を内部的に保持します。 もし動作中のコードがそんなオブジェクトを1000個保持していたら、 それだけで
1TB(!)のメモリを消費することになります。</p>

<p>このクラスは、<span class='object_link'><a href="MatchData.html" title="MatchData (class)">MatchData</a></span>と同じ情報を保持しますが、それは内部的に、 インデックスと(コピーではない)原文字列そのものだけです。したがって、
原文字列が外部のプロセスで破壊的に変更されない限り、このクラスの メソッドの返り値は、<span class='object_link'><a href="MatchData.html" title="MatchData (class)">MatchData</a></span>と同じです。念のため、このクラスの
インスタンスが生きている限り、原文字列がガーベージ・コレクトされる ことはありません。</p>

<p>一点、このクラス独自のパラメーターとして、インスタンス変数かつ
メソッドの<code>pos_begin</code>が導入されています。正規表現マッチの
開始ポジション(Integer)を(ユーザーが設定することで)保持します。</p>

<p>なお、このライブラリを require した時、演算子 <span class='object_link'><a href="MatchData.html#%3D%3D-instance_method" title="MatchData#== (method)">MatchData#==</a></span> が変更され、<span class='object_link'><a href="MatchSkeleton.html" title="MatchSkeleton (class)">MatchSkeleton</a></span>
と比較できるようになります。 結果、同演算子は、ダック・タイピングとして、 #string, #regexp, および
#pre_matchに依存するようになります。 一方、MatchData#eql? は影響を受けません。すなわち、
MatchData#eql? あるいは <span class='object_link'><a href="MatchSkeleton.html#eql%3F-instance_method" title="MatchSkeleton#eql? (method)">MatchSkeleton#eql?</a></span>によって、 <span class='object_link'><a href="MatchData.html" title="MatchData (class)">MatchData</a></span> と
<span class='object_link'><a href="MatchSkeleton.html" title="MatchSkeleton (class)">MatchSkeleton</a></span> オブジェクトを比較すると常に 偽(false)を返します。</p>

<h2 id="label-E3-82-A4-E3-83-B3-E3-82-B9-E3-83-88-E3-83-BC-E3-83-AB">インストール</h2>

<p>gem を使ってインストールできます。</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_match_skeleton'>match_skeleton</span>
</code></pre>

<p>もしくは以下から入手して下さい。</p>

<p><a href="https://rubygems.org/gems/match_skeleton" target="_parent" title="https://rubygems.org/gems/match_skeleton">https://rubygems.org/gems/match_skeleton</a></p>

<p>あとは、以下で一発です。</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>match_skeleton</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<p>お楽しみあれ!</p>

<h2 id="label-E5-8D-98-E7-B4-94-E3-81-AA-E4-BD-BF-E7-94-A8-E4-BE-8B">単純な使用例</h2>

<p>以下に幾つかの基本的な使用例を列挙します。</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>match_skeleton</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Something_Big.</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_pos'>pos</span> <span class='op'>=</span> <span class='int'>3</span>
<span class='id identifier rubyid_mtch'>mtch</span> <span class='op'>=</span> <span class='id identifier rubyid_str'>str</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(.)big</span><span class='regexp_end'>/i</span></span><span class='comma'>,</span> <span class='id identifier rubyid_pos'>pos</span><span class='rparen'>)</span>
<span class='id identifier rubyid_mskn'>mskn</span> <span class='op'>=</span> <span class='const'>MatchSkeleton</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_mtch'>mtch</span><span class='comma'>,</span> <span class='id identifier rubyid_str'>str</span><span class='comma'>,</span> <span class='label'>pos_begin:</span> <span class='id identifier rubyid_pos'>pos</span><span class='rparen'>)</span>

<span class='id identifier rubyid_mtch'>mtch</span> <span class='op'>==</span> <span class='id identifier rubyid_mskn'>mskn</span>     <span class='comment'># =&gt; true
</span><span class='id identifier rubyid_mskn'>mskn</span><span class='period'>.</span><span class='id identifier rubyid_string'>string</span>      <span class='comment'># =&gt; &quot;Something_Big.&quot;
</span><span class='id identifier rubyid_mskn'>mskn</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>          <span class='comment'># =&gt; &quot;_&quot;
</span><span class='id identifier rubyid_mskn'>mskn</span><span class='period'>.</span><span class='id identifier rubyid_pos_begin'>pos_begin</span>   <span class='comment'># =&gt; 3
</span>
<span class='id identifier rubyid_mskn'>mskn</span><span class='period'>.</span><span class='id identifier rubyid_post_match'>post_match</span>  <span class='comment'># =&gt; &quot;.&quot;
</span><span class='id identifier rubyid_mtch'>mtch</span><span class='period'>.</span><span class='id identifier rubyid_post_match'>post_match</span>  <span class='comment'># =&gt; &quot;.&quot;
</span><span class='id identifier rubyid_str'>str</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>1</span><span class='comma'>,</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_mskn'>mskn</span><span class='period'>.</span><span class='id identifier rubyid_post_match'>post_match</span>  <span class='comment'># =&gt; &quot;%&quot;  # 元文字列が破壊的に変更された結果。そんなことはしないように……。
</span><span class='id identifier rubyid_mtch'>mtch</span><span class='period'>.</span><span class='id identifier rubyid_post_match'>post_match</span>  <span class='comment'># =&gt; &quot;.&quot;
</span><span class='id identifier rubyid_mtch'>mtch</span> <span class='op'>==</span> <span class='id identifier rubyid_mskn'>mskn</span>     <span class='comment'># =&gt; false
</span></code></pre>

<h2 id="label-E6-97-A2-E7-9F-A5-E3-81-AE-E3-83-90-E3-82-B0">既知のバグ</h2>
<ul><li>
<p>なし。</p>
</li></ul>

<p>このライブラリは Ruby 2.0 以上でのみ挙動試験されています。 1.8以前でも動くかもしれませんが、テストされていません。</p>

<p>パッケージに含まれている通り、網羅的なテストが実行されています。</p>

<h2 id="label-E8-AC-9D-E8-BE-9E">謝辞</h2>

<p>この開発は、ワイズバベル社(<a href="http://www.wisebabel.com/en">Wise Babel
Ltd</a>)に支援されています。</p>

<p><a href="http://www.wisebabel.com/ja">www.wisebabel.com/ja</a></p>

<h2 id="label-E8-91-97-E4-BD-9C-E6-A8-A9-E4-BB-96-E6-83-85-E5-A0-B1">著作権他情報</h2>
<dl class="rdoc-list note-list"><dt>著者
<dd>
<p>Masa Sakano &lt; imagine a_t sakano dot co dot uk &gt;</p>
</dd><dt>利用許諾条項
<dd>
<p>MIT.</p>
</dd><dt>保証
<dd>
<p>一切無し。</p>
</dd><dt>バージョン
<dd>
<p>Semantic Versioning (2.0.0) <a href="http://semver.org">semver.org</a>/</p>
</dd></dl>
</div></div>

    <div id="footer">
  Generated on Thu May 19 14:51:47 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.3.0).
</div>

  </body>
</html>